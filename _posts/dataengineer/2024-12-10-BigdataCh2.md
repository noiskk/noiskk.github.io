---
layout: post
title: "[책] 빅데이터를 지탱하는 기술 _ ch2"
date: 2024-12-10 00:00:00 +0900
categories: book
---

#  **CH.2 빅데이터의 탐색** 
<br>
> 2장은 데이터 분석(시각화)에 대해 다루기 때문에 <br> 데이터 엔지니어링에 대한 부분만 간단히 정리해보았다. <br>


## **크로스 집계의 기본**

크로스 테이블
: 행과 열이 교차하는 부분에 숫자 데이터가 들어가는 테이블
- 사람들이 보기 쉽다.
- 데이터베이스로 다루기 어렵다.

<br>
트랜잭션 테이블
: 열방향으로 데이터가 증가하지 않고 행 방향으로 증가하는 테이블
- 데이터베이스에서 다루는 형식

<br>
크로스 집계
: 트랜잭션 테이블에서 크로스 테이블로 변경해주는 작업
  - Excel, Tableau, Pandas, SQL 등 이용

<br>
데이터 집계 &rarr; 데이터 마트 &rarr; 시각화
: - 데이터 마트가 작으면 시각화가 쉽지만 정보가 부족해질 수 있다.
- 데이터 마트가 크면 정보는 많지만 시각화가 어려워질 수 있다. 
- Trade-off 관계 : **데이터 마트의 크기**에 따라 시스템 구성이 결정된다.
<br>

-------


## **열 지향 스토리지에 의한 고속화**

대량의 데이터를 신속하게 집계하려면, 미리 데이터를 집계에 적합한 형태로 변환하는 것이 필요하다. <br>
데이터베이스의 지연을 줄이기 위해 **'압축'**과 **'분산'** 기법이 사용된다. 

#### **열 지향 데이터베이스 접근**

일반적으로 사용되는 데이터베이스는 **'행 지향 데이터베이스'**이다. <br>

행 지향 데이터베이스
: 행 단위로 데이터를 저장하고 조회하는 방식
  - 새 레코드를 빠르게 추가할 수 있다. 
  - 데이터 검색을 위해 '인덱스'를 만들어 사용한다. 

하지만 일부 칼럼만이 집계 대상이 되는 데이터 분석에서는 **'열 지향'** 개념이 사용된다. <br>

열 지향 데이터베이스
: 열 단위로 데이터를 저장하고 조회하는 방식
  - 필요한 열만 로드하여 디스크 I/O를 줄일 수 있다.
  - 데이터의 압축 효율이 우수하다. (같은 열에는 유사한 데이터가 나열되기 때문)

#### **MPP 데이터베이스의 접근 방식**

MPP 아키텍처에 의한 데이터 처리의 **병렬화**로도 쿼리 지연을 줄일 수도 있다. <br>

MPP 데이터베이스
: 대량의 데이터를 처리하기 위해 여러 개의 프로세서와 저장 장치를 동시에 활용하는 데이터베이스
  - 분산 저장 : 여러 디스크에 데이터가 분산 저장된다. 
  - 병렬 처리 : 여러 프로세서가 동시에 데이터를 처리한다. 
  - 쿼리 처리 : 한 쿼리를 여러 개의 작은 작업으로 쪼개어 계산한다. 

<img src="/assets/img/MPP.png" alt="MPP에 의한 분산처리" width="600" height="400">


MPP의 아키텍처는 Hadoop과 연동되어 대화형 쿼리 엔진으로도 채택되고 있다. 

> 대화형 쿼리 엔진
> : 실시간으로 데이터를 쿼리하고 분석할 수 있도록 설계된 데이터 처리 시스템 

<br>


-----

<br>

## **데이터 마트의 기본 구조**

#### **테이블 비정규화하기**

정규화
: 데이터 중복을 최소화하기 위해 테이블을 분리하는 것

<br>

데이터베이스의 설계에서는 테이블을 **마스터**와 **트랜잭션**으로 구분하기도 한다. 

트랜잭션
: 시간과 함께 생성되는 데이터를 기록한 것<br>
> [판매이력] 판매일, 상품ID, 점포ID, 고객ID, 금액

마스터
: 트랜잭션에서 참고되는 각종 정보 <br>
> [상품] 상품ID, 상품명, 가격<br> 
> [점포] 점포ID, 점포명, 주소<br> 
> [고객] 고객ID, 이름, 주소

<br>

**데이터 웨어하우스**에서는 트랜잭션처럼 사실이 기록된 것을 **팩트 테이블**이라고 하고, <br>
거기에서 참고되는 마스터 데이터 등을 **디멘전 테이블**이라고 한다. 

<br>

<span style="font-size: 1.2em;">**스타 스키마와 비정규화**</span> 
<br>

**데이터 마트**를 만들 때 팩트 테이블을 중심으로 여러 디멘전 테이블을 결합한다. <br>
이때 별 모양 구조가 만들어 지는데, 이를 **스타 스키마**라고 한다. <br><br>
**디멘전 테이블** 작성 시에는 정규화에 의해 분해된 테이블을 결합하는 과정이 필요하다. <br>
이는 정규화의 반대 작업인 **비정규화**이다. <br><br>
하지만 **열 지향 스토리지**를 사용하게 되면서 디멘전 테이블로 테이터를 이동시킬 필요가 없어졌다. <br>
하나의 거대한 팩트 테이블만 있어도 충분하기 때문에 스타 스키마의 형태도 비정규화를 통해 하나로 통합하면 된다. <br>
즉, 모든 테이블을 결합한 하나의 거대한 테이블만 존재하게 되고 이것이 **비정규화 테이블**이다. <br><br>
대부분의 경우에서 **데이터 마트**의 구조는 **비정규화 테이블**로 하는 것이 가장 단순하며, 충분히 효율적이다. <br>
( 데이터 웨어하우스의 테이블 구조에서는 스타 스키마가 우수하다. )

 <br>

<img src="/assets/img/StarSchema.png" alt="스타 스키마와 비정규화" width="600" height="400">

